[
  {
    "objectID": "cfDNA_analysis_report_standalone.html",
    "href": "cfDNA_analysis_report_standalone.html",
    "title": "Cell-free DNA Whole-Genome Bisulfite Sequencing Analysis of ALS vs Control",
    "section": "",
    "text": "Cell-free DNA (cfDNA) analysis has emerged as a powerful non-invasive approach for disease detection and monitoring. In this study, we analyze cfDNA from whole-genome bisulfite sequencing (WGBS) data to distinguish amyotrophic lateral sclerosis (ALS) patients from healthy controls.\nThe analysis integrates multiple cfDNA features:\n\nQuality Control: Mapping statistics, bisulfite conversion efficiency, and coverage metrics\nInsert Size Analysis: Insert size distributions and nucleosome positioning patterns\nEnd Motif Profiling: 5’ end 4-mer motif frequencies reflecting nuclease preferences\nDNA Methylation: Differentially methylated regions (DMRs) using dmrseq\nMachine Learning Classification: Random Forest with nested cross-validation\n\n\n\n\n\n\nSample distribution by group\n\n\nGroup\nN Samples\n\n\n\n\nCtrl\n10\n\n\nALS\n12\n\n\n\n\n\n\n\n\n\nAge Distribution Plot\n# Figure 0: Age distribution by group ----\np_age &lt;- ggplot(metadata, aes(x = Group, y = Age, fill = Group)) +\n  geom_boxplot(alpha = 0.8, outlier.shape = 16, outlier.size = 2) +\n  geom_jitter(width = 0.12, size = 1.8, alpha = 0.5) +\n  scale_fill_manual(values = COLORS) +\n  labs(title = \"Age distribution by group\", x = \"Group\", y = \"Age\") +\n  theme_classic(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5, size = rel(1.2),\n                              margin = ggplot2::margin(b = 8)),\n    plot.subtitle = element_text(hjust = 0.5, margin = ggplot2::margin(b = 6)),\n    axis.title = element_text(face = \"bold\"),\n    axis.text = element_text(color = \"black\"),\n    legend.title = element_text(face = \"bold\"),\n    panel.grid.major = element_line(color = \"gray90\", linewidth = 0.3, linetype = \"dotted\"),\n    plot.margin = ggplot2::margin(12, 12, 12, 12)\n  )\nggsave(file.path(FIG_DIR, \"fig0_age_distribution_by_group.png\"), p_age, width = 6, height = 5, dpi = 450)\n\n\n\n\n\n\n\n\nFigure 1: Age distribution by group showing comparable age ranges between ALS and Control cohorts."
  },
  {
    "objectID": "cfDNA_analysis_report_standalone.html#study-design",
    "href": "cfDNA_analysis_report_standalone.html#study-design",
    "title": "Cell-free DNA Whole-Genome Bisulfite Sequencing Analysis of ALS vs Control",
    "section": "",
    "text": "Sample distribution by group\n\n\nGroup\nN Samples\n\n\n\n\nCtrl\n10\n\n\nALS\n12\n\n\n\n\n\n\n\n\n\nAge Distribution Plot\n# Figure 0: Age distribution by group ----\np_age &lt;- ggplot(metadata, aes(x = Group, y = Age, fill = Group)) +\n  geom_boxplot(alpha = 0.8, outlier.shape = 16, outlier.size = 2) +\n  geom_jitter(width = 0.12, size = 1.8, alpha = 0.5) +\n  scale_fill_manual(values = COLORS) +\n  labs(title = \"Age distribution by group\", x = \"Group\", y = \"Age\") +\n  theme_classic(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5, size = rel(1.2),\n                              margin = ggplot2::margin(b = 8)),\n    plot.subtitle = element_text(hjust = 0.5, margin = ggplot2::margin(b = 6)),\n    axis.title = element_text(face = \"bold\"),\n    axis.text = element_text(color = \"black\"),\n    legend.title = element_text(face = \"bold\"),\n    panel.grid.major = element_line(color = \"gray90\", linewidth = 0.3, linetype = \"dotted\"),\n    plot.margin = ggplot2::margin(12, 12, 12, 12)\n  )\nggsave(file.path(FIG_DIR, \"fig0_age_distribution_by_group.png\"), p_age, width = 6, height = 5, dpi = 450)\n\n\n\n\n\n\n\n\nFigure 1: Age distribution by group showing comparable age ranges between ALS and Control cohorts."
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "",
    "text": "This report presents an representative analysis of a single cell-free DNA (cfDNA) sample from whole-genome bisulfite sequencing (WGBS) data. The analysis follows the same algorithms and methods used in the ALS vs Control study to ensure reproducibility and comparability.\n\n\nThe pipeline generates the following outputs:\n\nQuality Control Metrics: Mapping statistics, bisulfite conversion efficiency, and coverage metrics\nFragment Size Analysis: Insert size distributions showing the characteristic cfDNA nucleosome pattern\nFragmentation Ratio Track: Genome-wide short/long fragment ratio visualization\nGenomic Distribution: Distribution of fragment 5’ start sites across genomic features\nTSS Enrichment: Nucleosome positioning signal around transcription start sites\nEnd Motif Analysis: 5’ end 4-mer motif frequencies reflecting nuclease preferences\nClassification Prediction: Predicted group (ALS vs Ctrl) using pre-trained Random Forest model\n\n\n\n\nThis notebook requires two input files:\n\nBismark-aligned BAM file: Deduplicated BAM with XM methylation tags\nBismark coverage file: Output from bismark_methylation_extractor (.bismark.cov.gz)\n\n\n\n\n\n\n\nNoteHow to Generate Bismark Coverage File\n\n\n\n\n\nIf you only have a Bismark-aligned BAM file, run the following command to extract methylation calls:\nbismark_methylation_extractor --gzip --bedGraph \\\n  --cytosine_report --genome_folder /path/to/genome \\\n  your_sample.bam\nFor detailed documentation, see: Bismark Methylation Extraction"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#analysis-overview",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#analysis-overview",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "",
    "text": "The pipeline generates the following outputs:\n\nQuality Control Metrics: Mapping statistics, bisulfite conversion efficiency, and coverage metrics\nFragment Size Analysis: Insert size distributions showing the characteristic cfDNA nucleosome pattern\nFragmentation Ratio Track: Genome-wide short/long fragment ratio visualization\nGenomic Distribution: Distribution of fragment 5’ start sites across genomic features\nTSS Enrichment: Nucleosome positioning signal around transcription start sites\nEnd Motif Analysis: 5’ end 4-mer motif frequencies reflecting nuclease preferences\nClassification Prediction: Predicted group (ALS vs Ctrl) using pre-trained Random Forest model"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#input-files",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#input-files",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "",
    "text": "This notebook requires two input files:\n\nBismark-aligned BAM file: Deduplicated BAM with XM methylation tags\nBismark coverage file: Output from bismark_methylation_extractor (.bismark.cov.gz)\n\n\n\n\n\n\n\nNoteHow to Generate Bismark Coverage File\n\n\n\n\n\nIf you only have a Bismark-aligned BAM file, run the following command to extract methylation calls:\nbismark_methylation_extractor --gzip --bedGraph \\\n  --cytosine_report --genome_folder /path/to/genome \\\n  your_sample.bam\nFor detailed documentation, see: Bismark Methylation Extraction"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#r-packages",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#r-packages",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "2.1 R Packages",
    "text": "2.1 R Packages\n\n2.1.1 CRAN Packages\n\n\n\nRequired CRAN packages\n\n\nPackage\nVersion\nPurpose\n\n\n\n\nggplot2\n&gt;=3.4.0\nData visualization\n\n\ndplyr\n&gt;=1.1.0\nData manipulation\n\n\ntidyr\n&gt;=1.3.0\nData tidying\n\n\nreadr\n&gt;=2.1.0\nFile I/O\n\n\npurrr\n&gt;=1.0.0\nFunctional programming\n\n\nstringr\n&gt;=1.5.0\nString manipulation\n\n\ntibble\n&gt;=3.2.0\nModern data frames\n\n\npatchwork\n&gt;=1.1.0\nPlot composition\n\n\nhere\n&gt;=1.0.0\nProject-relative paths\n\n\nscales\n&gt;=1.2.0\nAxis formatting\n\n\nrandomForest\n&gt;=4.7\nClassification model\n\n\nknitr\n&gt;=1.40\nReport generation\n\n\nkableExtra\n&gt;=1.3.0\nTable formatting\n\n\n\n\n\n\n\n2.1.2 Bioconductor Packages\n\n\n\nRequired Bioconductor packages\n\n\nPackage\nVersion\nPurpose\n\n\n\n\nRsamtools\n&gt;=2.14.0\nBAM file handling\n\n\ncigarillo\n&gt;=1.0.0\nCIGAR string parsing\n\n\nGenomicRanges\n&gt;=1.50.0\nGenomic intervals\n\n\nIRanges\n&gt;=2.32.0\nInteger ranges\n\n\nS4Vectors\n&gt;=0.36.0\nS4 vector infrastructure\n\n\nBiostrings\n&gt;=2.66.0\nDNA sequence handling\n\n\nBSgenome.Hsapiens.UCSC.hg38\n&gt;=1.4.0\nHuman reference genome (hg38)\n\n\nGenomeInfoDb\n&gt;=1.34.0\nGenome metadata\n\n\nTxDb.Hsapiens.UCSC.hg38.knownGene\n&gt;=3.16.0\nGene annotations (hg38)\n\n\nGenomicFeatures\n&gt;=1.50.0\nGenomic features\n\n\nChIPseeker\n&gt;=1.34.0\nPeak annotation\n\n\norg.Hs.eg.db\n&gt;=3.16.0\nHuman gene IDs\n\n\nAnnotationDbi\n&gt;=1.60.0\nAnnotation infrastructure\n\n\nbsseq\n&gt;=1.34.0\nBisulfite-seq analysis\n\n\nGviz\n&gt;=1.42.0\nGenomic track visualization"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#external-tools",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#external-tools",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "2.2 External Tools",
    "text": "2.2 External Tools\n\n\n\nRequired external tools\n\n\nTool\nVersion\nPurpose\nLink\n\n\n\n\nBismark\n&gt;=0.24.0\nBisulfite read alignment & methylation extraction\n[GitHub](ht\n\n\nsamtools\n&gt;=1.17\nBAM file manipulation (indexing)\n[GitHub](ht\n\n\nQuarto\n&gt;=1.3.0\nDocument rendering\n[quarto.org\n\n\n\n\n\n\n\n\n\n\n\nTipInstallation Commands\n\n\n\n\n\n# CRAN packages\ninstall.packages(c(\"ggplot2\", \"dplyr\", \"tidyr\", \"readr\", \"purrr\", \n                   \"stringr\", \"tibble\", \"patchwork\", \"here\", \"scales\",\n                   \"randomForest\", \"knitr\", \"kableExtra\"))\n\n# Bioconductor packages\nif (!require(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(c(\n  \"Rsamtools\", \"cigarillo\", \"GenomicRanges\", \"IRanges\", \"S4Vectors\",\n  \"Biostrings\", \"BSgenome.Hsapiens.UCSC.hg38\", \"GenomeInfoDb\",\n  \"TxDb.Hsapiens.UCSC.hg38.knownGene\", \"GenomicFeatures\",\n  \"ChIPseeker\", \"org.Hs.eg.db\", \"AnnotationDbi\",\n  \"bsseq\", \"Gviz\"\n))"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-qc-viz",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-qc-viz",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "4.1 QC Metrics Visualization",
    "text": "4.1 QC Metrics Visualization\n\n\nShow code\n# Prepare data for bar chart\nqc_plot_data &lt;- tibble::tibble(\n  metric = c(\"Total Reads (M)\", \"Filtered Reads (M)\", \"Mean MAPQ\", \n             \"Median Fragment (bp)\", \"GC Content (%)\", \n             \"CpG Methylation (%)\", \"Bisulfite Conv. (%)\"),\n  value = c(\n    summary_stats$total_reads / 1e6,\n    summary_stats$filtered_reads / 1e6,\n    summary_stats$mean_mapq,\n    summary_stats$median_frag_length,\n    summary_stats$gc_content * 100,\n    summary_stats$cpg_methylation * 100,\n    summary_stats$bisulfite_conversion * 100\n  ),\n  category = c(\"Reads\", \"Reads\", \"Quality\", \"Fragment\", \"Fragment\", \"Methylation\", \"Methylation\")\n) %&gt;%\n  dplyr::mutate(\n    metric = factor(metric, levels = rev(metric)),\n    label = dplyr::case_when(\n      grepl(\"Reads\", metric) ~ sprintf(\"%.1fM\", value),\n      grepl(\"MAPQ\", metric) ~ sprintf(\"%.1f\", value),\n      grepl(\"Fragment\", metric) & !grepl(\"%\", metric) ~ sprintf(\"%.0f bp\", value),\n      TRUE ~ sprintf(\"%.1f%%\", value)\n    )\n  )\n\n# Create horizontal bar chart\np_qc &lt;- ggplot(qc_plot_data, aes(x = value, y = metric, fill = category)) +\n  geom_col(width = 0.7, alpha = 0.9) +\n  geom_text(aes(label = label), hjust = -0.1, size = 3.5, fontface = \"bold\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  scale_x_continuous(expand = expansion(mult = c(0, 0.25))) +\n  labs(\n    title = paste(\"QC Metrics:\", SAMPLE_ID),\n    subtitle = \"Key quality indicators from BAM file analysis\",\n    x = \"Value\",\n    y = NULL,\n    fill = \"Category\"\n  ) +\n  theme_pub(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    panel.grid.major.y = element_blank()\n  )\n\np_qc\n\n\n\n\n\n\n\n\nFigure 1: Key QC metrics for the sample"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-insert-size",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-insert-size",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "5.1 Insert Size Distribution",
    "text": "5.1 Insert Size Distribution\n\n\nShow code\n# Prepare fragment length data\nfrag_df &lt;- tibble::tibble(\n  fragment_length = metrics$fragment_lengths\n) %&gt;%\n  dplyr::filter(fragment_length &gt;= 80, fragment_length &lt;= 450)\n\n# Count fragments by length\ncounts_saw &lt;- frag_df %&gt;%\n  dplyr::count(fragment_length, name = \"n\")\n\n# Calculate mode for annotation\ncalc_mode &lt;- function(x) {\n  x &lt;- x[is.finite(x)]\n  if (length(x) == 0) return(NA_integer_)\n  x &lt;- as.integer(x)\n  tabulate(x, nbins = max(x)) |&gt; which.max()\n}\n\nmode_bp &lt;- calc_mode(metrics$fragment_lengths)\nmedian_bp &lt;- median(metrics$fragment_lengths, na.rm = TRUE)\nshort_n &lt;- sum(metrics$fragment_lengths &gt;= 100 & metrics$fragment_lengths &lt;= 150)\nlong_n &lt;- sum(metrics$fragment_lengths &gt;= 151 & metrics$fragment_lengths &lt;= 220)\nshort_long_ratio &lt;- if (long_n &gt; 0) short_n / long_n else NA\n\n# Create sawtooth plot\np_sawtooth &lt;- ggplot(counts_saw, aes(x = fragment_length, y = n)) +\n  geom_line(linewidth = 0.5, color = \"gray20\") +\n  geom_vline(xintercept = 167, linetype = \"dashed\", color = \"#E64B35\", linewidth = 0.6) +\n  geom_vline(xintercept = 334, linetype = \"dashed\", color = \"#4DBBD5\", linewidth = 0.6) +\n  annotate(\"text\", x = 175, y = max(counts_saw$n) * 0.95, \n           label = \"Mono-nucleosome\\n(~167 bp)\", hjust = 0, size = 3, color = \"#E64B35\") +\n  annotate(\"text\", x = 342, y = max(counts_saw$n) * 0.5, \n           label = \"Di-nucleosome\\n(~334 bp)\", hjust = 0, size = 3, color = \"#4DBBD5\") +\n  annotate(\"label\", x = 380, y = max(counts_saw$n) * 0.85,\n           label = sprintf(\"Median: %d bp\\nMode: %d bp\\nS/L ratio: %.3f\", \n                          as.integer(median_bp), mode_bp, short_long_ratio),\n           hjust = 0, size = 3, fill = \"white\", label.size = 0.3) +\n  labs(\n    title = \"cfDNA Fragment Size Distribution\",\n    subtitle = paste(\"Sample:\", SAMPLE_ID),\n    x = \"Fragment Length (bp)\",\n    y = \"Count\"\n  ) +\n  theme_pub(base_size = 12)\n\np_sawtooth\n\n\n\n\n\n\n\n\nFigure 2: Fragment size distribution showing characteristic cfDNA nucleosome pattern"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-frag-ratio",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-frag-ratio",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "5.2 Fragmentation Ratio Track",
    "text": "5.2 Fragmentation Ratio Track\nThe short/long fragment ratio varies across the genome and can reveal nucleosome positioning differences.\n\n\nShow code\n# Set up genomic bins (chr21 only for efficiency)\nbin_size &lt;- 2e6\nchroms &lt;- \"chr21\"\nseqlens &lt;- GenomeInfoDb::seqlengths(genome)[chroms]\nseqlens &lt;- seqlens[!is.na(seqlens)]\n\nbins_gr &lt;- GenomicRanges::tileGenome(\n  seqlengths = seqlens,\n  tilewidth = bin_size,\n  cut.last.tile.in.chrom = TRUE\n)\n\nbins_df &lt;- tibble::tibble(\n  bin_id = seq_along(bins_gr),\n  chrom = as.character(GenomeInfoDb::seqnames(bins_gr)),\n  start = start(bins_gr),\n  end = end(bins_gr),\n  mid = as.integer(floor((start + end) / 2))\n)\n\n# GC content per bin\nbin_seqs &lt;- Biostrings::getSeq(genome, bins_gr)\nfreq &lt;- Biostrings::letterFrequency(bin_seqs, letters = c(\"A\", \"C\", \"G\", \"T\", \"N\"), as.prob = FALSE)\nacgt &lt;- rowSums(freq[, c(\"A\", \"C\", \"G\", \"T\"), drop = FALSE])\ngc &lt;- (freq[, \"G\"] + freq[, \"C\"]) / pmax(acgt, 1)\nn_frac &lt;- freq[, \"N\"] / Biostrings::width(bin_seqs)\n\nbins_df &lt;- bins_df %&gt;%\n  dplyr::mutate(gc = as.numeric(gc), n_frac = as.numeric(n_frac))\n\n# GC filtering thresholds\ngc_min &lt;- 0.10\ngc_max &lt;- 0.85\nn_frac_max &lt;- 0.45\nbins_keep_for_gc &lt;- is.finite(bins_df$gc) &\n  bins_df$gc &gt;= gc_min & bins_df$gc &lt;= gc_max &\n  is.finite(bins_df$n_frac) & bins_df$n_frac &lt;= n_frac_max\n\n# Compute bin counts\nfragment_bed_path &lt;- file.path(TEMP_DIR, paste0(SAMPLE_ID, \".fragments.bed.gz\"))\nbin_tracks &lt;- bin_counts_one_sample(\n  path = fragment_bed_path,\n  bins_gr = bins_gr,\n  bins_df = bins_df,\n  bins_keep_for_gc = bins_keep_for_gc\n)\n\nbin_tracks &lt;- bin_tracks %&gt;%\n  dplyr::left_join(bins_df, by = \"bin_id\")\n\n\n\n\nShow code\n# Plot fragmentation ratio track\np_frag_track &lt;- ggplot(bin_tracks, aes(x = mid / 1e6, y = short_long_ratio)) +\n  geom_hline(yintercept = 1, color = \"gray70\", linewidth = 0.35) +\n  geom_line(linewidth = 0.8, color = \"#2E4A62\") +\n  geom_point(size = 1.5, color = \"#2E4A62\", alpha = 0.7) +\n  scale_x_continuous(breaks = seq(0, 50, by = 10)) +\n  labs(\n    title = paste(\"Fragmentation Ratio Track:\", SAMPLE_ID),\n    subtitle = sprintf(\"GC-corrected short(90-150bp)/long(151-220bp) ratio in %d Mb bins on chr21\", \n                      bin_size / 1e6),\n    x = \"Genomic Position (Mb)\",\n    y = \"Short/Long Ratio\"\n  ) +\n  theme_pub(base_size = 12)\n\np_frag_track\n\n\n\n\n\n\n\n\nFigure 3: Genome-wide fragmentation ratio track (GC-corrected short/long ratio)\n\n\n\n\n\n\n\nShow code\n# Gviz visualization\nif (requireNamespace(\"Gviz\", quietly = TRUE)) {\n  genome_build &lt;- \"hg38\"\n  chrom &lt;- \"chr21\"\n  from_bp &lt;- min(bins_df$start, na.rm = TRUE)\n  to_bp &lt;- max(bins_df$end, na.rm = TRUE)\n  \n  gr_bins &lt;- GenomicRanges::GRanges(\n    seqnames = bins_df$chrom,\n    ranges = IRanges::IRanges(start = bins_df$start, end = bins_df$end)\n  )\n  \n  y &lt;- bin_tracks$short_long_ratio\n  y_lim &lt;- range(y[is.finite(y)], na.rm = TRUE)\n  y_pad &lt;- 0.15 * diff(y_lim)\n  y_lim &lt;- c(y_lim[1] - y_pad, y_lim[2] + y_pad)\n  \n  axis_track &lt;- Gviz::GenomeAxisTrack(genome = genome_build, chromosome = chrom, name = \"\")\n  \n  ratio_track &lt;- Gviz::DataTrack(\n    range = gr_bins,\n    data = y,\n    genome = genome_build,\n    chromosome = chrom,\n    name = \"S/L ratio\",\n    type = \"l\",\n    col = \"#2E4A62\",\n    lwd = 2,\n    ylim = y_lim,\n    baseline = 1,\n    col.baseline = \"gray45\",\n    lty.baseline = 2,\n    lwd.baseline = 1,\n    cex.axis = 0.9,\n    cex.title = 0.9\n  )\n  \n  ideo_track &lt;- tryCatch(\n    Gviz::IdeogramTrack(genome = genome_build, chromosome = chrom),\n    error = function(e) NULL\n  )\n  \n  tracks &lt;- list(axis_track, ratio_track)\n  if (!is.null(ideo_track)) tracks &lt;- c(list(ideo_track), tracks)\n  \n  Gviz::plotTracks(\n    tracks,\n    from = from_bp,\n    to = to_bp,\n    background.title = \"white\",\n    col.title = \"black\",\n    cex.title = 0.95,\n    background.panel = \"white\",\n    col.axis = \"black\",\n    col.frame = \"gray85\"\n  )\n}\n\n\n\n\n\n\n\n\nFigure 4: Chromosome-style fragmentation ratio visualization"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-genomic-dist",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-genomic-dist",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "6.1 Genomic Distribution",
    "text": "6.1 Genomic Distribution\n\n\nShow code\n# Annotate fragment 5' starts\nstart_annot &lt;- annotate_fragment_starts_one_sample(\n  fragment_bed_gz = fragment_bed_path,\n  sample_id = SAMPLE_ID,\n  txdb = txdb\n)\n\n\n&gt;&gt; preparing features information...         2026-01-30 15:39:18 \n&gt;&gt; Using Genome: hg38 ...\n&gt;&gt; identifying nearest features...       2026-01-30 15:39:20 \n&gt;&gt; calculating distance from peak to TSS...  2026-01-30 15:39:21 \n&gt;&gt; assigning genomic annotation...       2026-01-30 15:39:21 \n&gt;&gt; Using Genome: hg38 ...\n&gt;&gt; Using Genome: hg38 ...\n&gt;&gt; adding flank feature information from peaks...    2026-01-30 15:40:02 \n&gt;&gt; assigning chromosome lengths          2026-01-30 15:40:07 \n&gt;&gt; done...                   2026-01-30 15:40:07 \n\n\n\n\nShow code\n# Prepare data for donut chart\nannot_data &lt;- start_annot %&gt;%\n  tidyr::pivot_longer(\n    cols = c(Promoter, Exon, Intron, Three_UTR, Five_UTR, Distal_Intergenic, Downstream),\n    names_to = \"annotation\",\n    values_to = \"n\"\n  ) %&gt;%\n  dplyr::mutate(\n    pct = 100 * n / sum(n),\n    annotation = dplyr::case_when(\n      annotation == \"Three_UTR\" ~ \"3' UTR\",\n      annotation == \"Five_UTR\" ~ \"5' UTR\",\n      annotation == \"Distal_Intergenic\" ~ \"Distal Intergenic\",\n      TRUE ~ annotation\n    ),\n    annotation = factor(annotation, levels = c(\"Promoter\", \"5' UTR\", \"Exon\", \"Intron\", \n                                               \"3' UTR\", \"Downstream\", \"Distal Intergenic\"))\n  ) %&gt;%\n  dplyr::arrange(annotation) %&gt;%\n  dplyr::mutate(\n    ymax = cumsum(pct),\n    ymin = dplyr::lag(ymax, default = 0),\n    label_pos = (ymin + ymax) / 2,\n    label = sprintf(\"%s\\n%.1f%%\", annotation, pct)\n  )\n\n# Create donut chart\np_donut &lt;- ggplot(annot_data, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 2.5, fill = annotation)) +\n  geom_rect(color = \"white\", linewidth = 0.5) +\n  geom_text(aes(x = 3.25, y = label_pos, label = sprintf(\"%.1f%%\", pct)), \n            size = 3, color = \"white\", fontface = \"bold\") +\n  coord_polar(theta = \"y\") +\n  xlim(c(1, 4)) +\n  scale_fill_brewer(palette = \"Set2\") +\n  annotate(\"text\", x = 1, y = 0, label = paste(\"Total\\n\", format(start_annot$total_starts, big.mark = \",\")),\n           size = 4, fontface = \"bold\") +\n  labs(\n    title = \"Genomic Distribution of Fragment 5' Starts\",\n    subtitle = paste(\"Sample:\", SAMPLE_ID),\n    fill = \"Annotation\"\n  ) +\n  theme_void(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14),\n    plot.subtitle = element_text(hjust = 0.5),\n    legend.position = \"right\"\n  )\n\np_donut\n\n\n\n\n\n\n\n\nFigure 5: Genomic distribution of fragment 5’ start sites"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-tss-enrichment",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-tss-enrichment",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "6.2 TSS Enrichment",
    "text": "6.2 TSS Enrichment\n\n\nShow code\n# Get muscle-related genes on chr21\nmuscle_symbols &lt;- c(\"COL6A1\", \"COL6A2\")\nmuscle_map &lt;- AnnotationDbi::select(\n  org.Hs.eg.db::org.Hs.eg.db,\n  keys = muscle_symbols,\n  keytype = \"SYMBOL\",\n  columns = c(\"SYMBOL\", \"ENTREZID\")\n) %&gt;%\n  dplyr::filter(!is.na(.data$ENTREZID)) %&gt;%\n  dplyr::mutate(ENTREZID = as.character(.data$ENTREZID))\n\ngenes_chr21 &lt;- suppressMessages(GenomicFeatures::genes(txdb))\ngenes_chr21 &lt;- genes_chr21[as.character(GenomeInfoDb::seqnames(genes_chr21)) == \"chr21\"]\ngenes_muscle &lt;- genes_chr21[as.character(genes_chr21$gene_id) %in% unique(muscle_map$ENTREZID)]\n\n# TSS windows for muscle genes\ntss_points_m &lt;- unique(GenomicRanges::promoters(genes_muscle, upstream = 0L, downstream = 1L))\ntss_windows_m &lt;- unique(GenomicRanges::promoters(genes_muscle, upstream = 2000L, downstream = 2000L))\ntss_site_m &lt;- start(tss_points_m)\ntss_strand_m &lt;- as.character(strand(tss_points_m))\n\n# Compute TSS enrichment profile\ntss_profile &lt;- profile_tss_enrichment_starts(\n  fragment_bed_gz = fragment_bed_path,\n  tss_windows = tss_windows_m,\n  tss_site = tss_site_m,\n  tss_strand = tss_strand_m,\n  flank = 2000L\n)\n\n\n\n\nShow code\n# Smooth the profile\ntss_profile_smooth &lt;- tss_profile %&gt;%\n  dplyr::mutate(\n    enrichment_smooth = moving_average(enrichment, k = 21),\n    enrichment_smooth = dplyr::if_else(is.na(enrichment_smooth), enrichment, enrichment_smooth)\n  )\n\np_tss &lt;- ggplot(tss_profile_smooth, aes(x = rel_bp, y = enrichment_smooth)) +\n  geom_hline(yintercept = 1, color = \"gray60\", linewidth = 0.35) +\n  geom_vline(xintercept = 0, color = \"gray30\", linewidth = 0.5) +\n  geom_line(linewidth = 0.9, color = \"#2E4A62\") +\n  annotate(\"text\", x = 50, y = max(tss_profile_smooth$enrichment_smooth, na.rm = TRUE) * 0.95,\n           label = \"TSS\", hjust = 0, size = 4, fontface = \"bold\") +\n  labs(\n    title = \"TSS Enrichment of Fragment 5' Start Sites\",\n    subtitle = paste(\"Muscle genes (COL6A1, COL6A2) on chr21 | Sample:\", SAMPLE_ID),\n    x = \"Distance to TSS (bp)\",\n    y = \"Normalized Fragment Density\"\n  ) +\n  theme_pub(base_size = 12)\n\np_tss\n\n\n\n\n\n\n\n\nFigure 6: TSS enrichment of fragment 5’ start sites around muscle genes on chr21"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-top-motifs",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-top-motifs",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "7.1 Top 20 End Motifs",
    "text": "7.1 Top 20 End Motifs\n\n\nShow code\n# Get top 20 motifs\ntop20_motifs &lt;- motif_freq %&gt;%\n  dplyr::arrange(desc(frequency)) %&gt;%\n  dplyr::slice_head(n = 20) %&gt;%\n  dplyr::mutate(motif = factor(motif, levels = rev(motif)))\n\np_top20 &lt;- ggplot(top20_motifs, aes(x = frequency, y = motif)) +\n  geom_col(fill = \"#3C5488\", alpha = 0.9, width = 0.7) +\n  geom_text(aes(label = sprintf(\"%.4f\", frequency)), hjust = -0.1, size = 3) +\n  scale_x_continuous(expand = expansion(mult = c(0, 0.15))) +\n  labs(\n    title = \"Top 20 cfDNA 5' End Motifs (4-mer)\",\n    subtitle = paste(\"Sample:\", SAMPLE_ID),\n    x = \"Frequency\",\n    y = \"Motif\"\n  ) +\n  theme_pub(base_size = 12) +\n  theme(panel.grid.major.y = element_blank())\n\np_top20\n\n\n\n\n\n\n\n\nFigure 7: Top 20 cfDNA 5’ end motifs (4-mer)"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-mds",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#sec-mds",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "7.2 Motif Diversity Score",
    "text": "7.2 Motif Diversity Score\nThe Motif Diversity Score (MDS) is calculated as the normalized Shannon entropy of the 256 4-mer frequencies.\n\n\nShow code\n# Calculate MDS\nfreq_vec &lt;- motif_freq$frequency\nentropy_bits &lt;- shannon_entropy_bits(freq_vec)\nmax_entropy &lt;- log2(256)  # Maximum possible entropy for 256 motifs\nmds &lt;- entropy_bits / max_entropy\n\nmds_display &lt;- tibble::tibble(\n  Metric = c(\"Shannon Entropy (bits)\", \"Maximum Entropy (bits)\", \"Motif Diversity Score (MDS)\"),\n  Value = c(sprintf(\"%.4f\", entropy_bits), sprintf(\"%.4f\", max_entropy), sprintf(\"%.4f\", mds))\n)\n\nknitr::kable(mds_display, caption = \"End Motif Diversity Metrics\") %&gt;%\n  kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n\n\n\nEnd Motif Diversity Metrics\n\n\nMetric\nValue\n\n\n\n\nShannon Entropy (bits)\n7.6745\n\n\nMaximum Entropy (bits)\n8.0000\n\n\nMotif Diversity Score (MDS)\n0.9593\n\n\n\n\n\n\n\nShow code\n# Create a simple gauge-like visualization for MDS\np_mds &lt;- ggplot() +\n  geom_rect(aes(xmin = 0, xmax = 1, ymin = 0, ymax = 1), fill = \"gray90\") +\n  geom_rect(aes(xmin = 0, xmax = mds, ymin = 0, ymax = 1), fill = \"#3C5488\", alpha = 0.8) +\n  geom_text(aes(x = 0.5, y = 0.5, label = sprintf(\"MDS = %.4f\", mds)), \n            size = 8, fontface = \"bold\", color = \"white\") +\n  geom_text(aes(x = 0.5, y = -0.3, label = \"Shannon entropy of 256 4-mer frequencies (normalized)\"),\n            size = 3.5, color = \"gray40\") +\n  scale_x_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +\n  scale_y_continuous(limits = c(-0.5, 1.2)) +\n  labs(title = paste(\"Motif Diversity Score:\", SAMPLE_ID)) +\n  theme_void(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14, margin = ggplot2::margin(b = 10)),\n    axis.text.x = element_text(color = \"gray30\"),\n    axis.ticks.x = element_line(color = \"gray30\")\n  )\n\np_mds\n\n\n\n\n\n\n\n\nFigure 8: Motif Diversity Score (MDS) - Normalized Shannon entropy of 256 4-mer frequencies"
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#data-processing",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#data-processing",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "10.1 Data Processing",
    "text": "10.1 Data Processing\nThe BAM file was processed using custom R functions that implement the following pipeline:\n\nRead Filtering: Reads were filtered to retain properly paired, non-duplicate alignments with MAPQ ≥ 30.\nFragment Extraction: Fragment coordinates were derived from paired-end alignments using the union span of mate alignments.\nGC Content: Fragment GC content was calculated as (G+C)/(A+C+G+T) excluding N bases.\nMethylation Extraction: CpG methylation was extracted from Bismark XM tags or coverage files."
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#fragmentation-analysis",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#fragmentation-analysis",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "10.2 Fragmentation Analysis",
    "text": "10.2 Fragmentation Analysis\n\nInsert Size Distribution: Fragment lengths were computed from paired-end alignment coordinates.\nShort/Long Ratio: Ratio of fragments 90-150 bp (short) to 151-220 bp (long).\nGC Correction: LOESS regression was used to correct for GC bias in fragment counts."
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#end-motif-analysis",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#end-motif-analysis",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "10.3 End Motif Analysis",
    "text": "10.3 End Motif Analysis\n\nMotif Extraction: 4-mer sequences were extracted from both 5’ ends of each fragment (strand-aware).\nMotif Diversity Score: Calculated as normalized Shannon entropy: MDS = H(p) / log₂(256)."
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#classification",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#classification",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "10.4 Classification",
    "text": "10.4 Classification\n\nModel: Random Forest classifier trained on ALS vs Control cohort data.\nFeatures: stackHMM-based regional methylation levels (100 chromatin states).\nValidation: Nested cross-validation (LOOCV outer, 5-fold inner) with Boruta feature selection."
  },
  {
    "objectID": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#software",
    "href": "single_sample_cfdna_analysis/single_sample_cfdna_analysis.html#software",
    "title": "Single-Sample cfDNA WGBS Analysis Report",
    "section": "10.5 Software",
    "text": "10.5 Software\nThis analysis was performed using R version R version 4.5.1 (2025-06-13) with Bioconductor packages for genomic analysis. All core algorithms are identical to those used in the cohort analysis to ensure reproducibility.\n\nReport generated on 2026-01-30 16:19:22.425818"
  }
]